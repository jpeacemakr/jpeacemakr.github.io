<!DOCTYPE html>
<html>
  <head>
    
    <!-- This is a website designed and coded by James Peacemaker Jr.
      It uses Dolly, his dog as a fun way to display the weather.
      It uses three API calls from the National Weather Service. 
      (Get location based on GPS, get daily weather forecast, and get hourly forecast)
      https://www.weather.gov/documentation/services-web-api -->


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Dolly the Doggo's Weather Forecast</title>
    <link href="css/style.css#updated-6-7-2022" rel="stylesheet">

    <style>
    </style>

  </head>



  <body onload="getLocation()" onscroll="hideHeader()">
    <div id="backdropimage"></div>

    <!-- sticky header -->
    <div id="header" class="sticky-top">

      <div id="weatheralertouter">
        <div id="weatheralert" onclick="toggleWeatherAlert()">
          <h2 id="weatheralerthead">Bark! Bark! Bark! (Weather Alert)</h2>
          <h2 id="weatheralerthead2">Bark! (Weather Alert)</h2>
          <div id="weatheralertbody">Wait while I sniff for weather alerts.</div>
        </div>
      </div>
      <h1 id="headerhead2">Dolly the Doggo's Weather Forecast</h1>
      <h1 id="headerhead">Dolly's Weather</h1>
      <div id="location"></div>
        
    </div>

    
    <!-- daily forecasts -->
    <div class="container-fluid">
      <div id="dailyforecast" class="row">
      </div>
    </div>
    
    <!-- hourly forecasts -->
    <div id="hourlyforecast"><h2>Bark, world!</h2>
      <p>Just wait a second while I fetch the data from the National Weather Service. 
      <br>Press the "Allow" button if your browser asks if I can know your location.
      <br>This site only works for areas covered by the United States National Weather Service.
      <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>&nbsp;</p>
    </div>

    <div id="footer">
      <p>Copyright 2022, Peacemaker Media Empire. Weather data from <a href ="https://www.weather.gov/documentation/services-web-api">National Weather Service API</a>. If the information on this page is bad, don't blame us. You are the one who got your weather from a dog.</p>
    </div>

  </body>



  <script>
    
    // json data retrieved from weather service
    let positionResult; // stores location json info
    let weatherResult; // stores daily weather forecast json info
    let weatherResultHourly; // stores hourly weather forecast json info

    // arrays to store info for each day of the week. Typically 0..7 or 0..8
    let weatherResultArray = [];
    let weatherAbbreviationArray = [];
    let weatherImageArray = [];



    // use weather information to get what dolly says
    // day is day of week 0-X that image will be assigned to
    // position is position of data (0-13) from weather service API. 
    // num is number of positions to include (1 for half day or 2 for full day)
    function dollySays(day, position, num) {
    
      let dollyWords = ""; // the string that will be built
      let dollyWordsObject; // object to be assigned { words:"xxx", image:"xxx", position:"xxxx" }. 
                            // it will store the last object (image and position to be used) as the string is being built.
                            // this setup allows an image and position to be linked with a specific phrase
                            // the array of phrase objects allows one of the phrases to be randomly chosen for a particular weather type
        
      // level of sunshine
      const clearWords = [
        { words: " It would be good night to chase opossums!", image: "night.jpg", position: "bottom center" }, 
        { words: " Maybe I will see the sky ball tonight.", image: "night.jpg", position: "bottom center" },
        { words: " Maybe the raccoon will visit my trash tonight (That's where the no-no food goes).", image: "night.jpg", position: "bottom center" }

      ];
      const sunWords = [
        { words: " Today would be good day for a cheeseburger party in the backyard.", image: "cookout4.jpg", position: "center right" },
        { words: " It will be bright today.", image: "sun1.jpg", position: "bottom center" },
        { words: " Today will be a good day to lie in the sun.", image: "grass.jpg", position: "top right" },
        { words: " The sun can warm my belly today. Not as good as chicken warms my belly, but good enough.", image: "grass.jpg", position: "top right" },
        { words: " Sun's out, tongues out!", image: "bench.jpg", position: "top left" }

      ];
      const mostSunWords = [
        { words: " There will only be a few sky fluffs in the air today.", image: "bench.jpg", position: "top left" }

      ];
      const partSunWords = [
        { words: " There will some sky fluffs in the air today.", image: "sunset.jpg", position: "center right" },
        { words: " Would be a good day to drive to Dairy Queen? I sit in backseat and wait for cheeseburger.", image: "drive.jpg", position: "center center" }

      ];
      const partCloudWords = [
        { words: " There will be some sky fluffs in the air today.", image: "sunset.jpg", position: "center right" }

      ];
      const mostCloudWords = [
        { words: " There will be a lot of sky fluffs in the air today.", image: "sunset.jpg", position: "center right" }

      ];
      const cloudWords = [
        { words: " The sky fluffs will fill the air today.", image: "sunset.jpg", position: "center right" }

      ];

      // temperature
      const hotWords = [
        { words: " It will be so hot. Bring water bowl on your walk.", image: "grass.jpg", position: "top right" },
        { words: " Keep paws off the outdoor floor so they don't get burned.", image: "corner.jpg", position: "bottom left" },
        { words: " It is hot. Can I has trip to the pool too?", image: "drive.jpg", position: "center center" },
        { words: " So hot. It would be good day for ice cream cone. Peanut butter is my favorite, not doggo cone!", image: "cone2.jpg", position: "top center" },
        { words: " When I go outside, I has the pants!", image: "bench.jpg", position: "top left" }

      ];
      const warmWords = [
        { words: " It will be so hot. Bring water bowl on your walk.", image: "sun1.jpg", position: "center center" },
        { words: " Keep paws off the outdoor floor so they don't get burned.", image: "corner.jpg", position: "bottom right" },
        { words: " Can I has trip to the pool too?", image: "drive.jpg", position: "center center" },
        { words: " It would be good day for ice cream cone. Peanut butter is my favorite, not doggo cone!", image: "cone2.jpg", position: "top center" },
        { words: " When I go outside, I has the pants!", image: "bench.jpg", position: "top left" }

      ];
      const coolWords = [
        { words: " It will be so cold that I need my extra fur.", image: "night.jpg", position: "bottom center" },
        { words: " I found this leaf on my walk. I thought it was banana. It does not taste like banana but I carry it home anyways.", image: "banana.jpg", position: "center left" },
        { words: " It will be cold, but nice hot chicken could keep me warm.", image: "night.jpg", position: "bottom center" }

      ];
      const coldWords = [
        { words: " It will be so cold that I need my extra fur.", image: "night.jpg", position: "bottom center" },
        { words: " It will be cold, but nice hot chicken could keep me warm.", image: "night.jpg", position: "bottom center" }

      ];
      
      // precipitation
      const chanceRainWords = [ 
        { words: " The sky fluffs might be drooling.", image: "rain2.jpg", position: "top right" }, 
        { words: " I might brings in the mud from the walk.", image: "rain1.jpg", position: "top right" },
        { words: " It might be a good day for couch cuddles if too wet for walks.", image: "rain2.jpg", position: "top right" },
        { words: " Outside might be like bath time.", image: "rain2.jpg", position: "top right" }

      ];
      const rainWords = [ 
        { words: " The sky fluffs will be drooling.", image: "rain2.jpg", position: "top right" }, 
        { words: " I will bring in the mud from the walk.", image: "rain1.jpg", position: "top right" },
        { words: " Rain makes it a good day for couch cuddles.", image: "ferocious.jpg", position: "center right" },
        { words: " Outside will be like bath time.", image: "rain2.jpg", position: "top right" }

      ];
      const chanceStormWords = [
        { words: " The sky fluffs might get angry today.", image: "rain2.jpg", position: "top right" },
        { words: " I might get scared by the sky booms!", image: "rain1.jpg", position: "top right" },
        { words: " Me and Papa like to sit on the swing and watch lightnings.", image: "rain2.jpg", position: "top right" }

      ];
      const stormWords = [
        { words: " Try not to get scared by the sky booms!", image: "rain2.jpg", position: "top right" },
        { words: " The sky fluffs will be angry today!", image: "rain1.jpg", position: "top right" },
        { words: " Me and Papa like to sit on the swing and watch lightnings.", image: "rain2.jpg", position: "top right" }

      ];
      const snowWords = [
        { words: " Good time for couch snuggles.", image: "night.jpg", position: "bottom center" }

      ];
      const chanceSnowWords = [
        { words: " Good time for couch snuggles.", image: "night.jpg", position: "bottom center" }

      ];
      
      // wind
      const windWords = [
        { words: " The sky fluffs will be running fast today.", image: "grass.jpg", position: "top right" }, 
        { words: " Be careful which way you pees today.", image: "grass.jpg", position: "top right" }

      ];
      
      // perfect weather
      const perfectWords = [
        { words: " It is a great day for lots of walks!", image: "sun1.jpg", position: "center center" }

      ];
      
      
      // assigns dollyWordsObject (stores image and position to use) and adds words to dollyWords
      function randomWords (wordsArray) {
        // pick a random phrase from the array of choices
        dollyWordsObject = wordsArray [ Math.floor ( Math.random() * wordsArray.length ) ];
        // concatenate the small phrase onto the larger whole phrase
        dollyWords += dollyWordsObject.words;
      }

      /* 
      DATA TO USE
      weatherResult.properties.periods[position].name 
      weatherResult.properties.periods[position].shortForecast 
      weatherResult.properties.periods[position].temperature 
      weatherResult.properties.periods[position].windSpeed
      weatherResult.properties.periods[position].windDirection
      weatherResult.properties.periods[position].detailedForecast

      weatherResult.properties.periods[position+1].name 
      weatherResult.properties.periods[position+1].shortForecast 
      weatherResult.properties.periods[position+1].temperature 
      weatherResult.properties.periods[position+1].windSpeed
      weatherResult.properties.periods[position+1].windDirection
      weatherResult.properties.periods[position+1].detailedForecast
      */

      // check the season?
      // check for holiday?


      // level of sunshine
      // If clear
      if (weatherResult.properties.periods[position].shortForecast.startsWith("Clear")) {
          randomWords(clearWords);
      }
      // If mostly clear
      if (weatherResult.properties.periods[position].shortForecast.startsWith("Mostly Clear")) {
          randomWords(clearWords);
      }
      // If partly clear
      if (weatherResult.properties.periods[position].shortForecast.startsWith("Partly Clear")) {
          randomWords(clearWords);
      }
      // if sunny
      else if (weatherResult.properties.periods[position].shortForecast.startsWith("Sunny")) {
        randomWords(sunWords);  
      }
      // if mostly sunny
      else if (weatherResult.properties.periods[position].shortForecast.startsWith("Mostly Sunny")) {
        randomWords(mostSunWords);  
      }
      // if partly sunny
      else if (weatherResult.properties.periods[position].shortForecast.startsWith("Partly Sunny")) {
        randomWords(partCloudWords);  
      }
      // if partly cloudy
      else if (weatherResult.properties.periods[position].shortForecast.startsWith("Partly Cloudy")) {
        randomWords(partCloudWords);  
      }
      // if mostly cloudy
      else if (weatherResult.properties.periods[position].shortForecast.startsWith("Mostly Cloudy")) {
        randomWords(partCloudWords);  
      }
      // if cloudy
      else if (weatherResult.properties.periods[position].shortForecast.startsWith("Cloudy")) {
        randomWords(cloudWords);  
      }


      // temperature
      if (weatherResult.properties.periods[position].temperature <= 32) {
        randomWords(coldWords);  
      } else if (weatherResult.properties.periods[position].temperature <= 50) {
        randomWords(coolWords);  
      } else if (weatherResult.properties.periods[position].temperature >= 90) {
        randomWords(hotWords);  
      } else if (weatherResult.properties.periods[position].temperature >= 80) {
        randomWords(warmWords);  
      }


      // precipitation
      // chance
      if (weatherResult.properties.periods[position].detailedForecast.includes("chance")) {

        if (weatherResult.properties.periods[position].detailedForecast.includes("showers")) {
          randomWords(chanceRainWords);
        }
        if (weatherResult.properties.periods[position].detailedForecast.includes("thunderstorms")) {
          randomWords(chanceStormWords);
        }
        if (weatherResult.properties.periods[position].detailedForecast.includes("snow")) {
          randomWords(chanceSnowWords);
        }
      // full on
      } else {
        if (weatherResult.properties.periods[position].detailedForecast.includes("showers")) {
          randomWords(rainWords);
        }
        if (weatherResult.properties.periods[position].detailedForecast.includes("thunderstorms")) {
          randomWords(stormWords);
        }
        if (weatherResult.properties.periods[position].detailedForecast.includes("snow")) {
          randomWords(snowWords);
        }
      }
      
      
      // if windy
      if (weatherResult.properties.periods[position].windSpeed >= 10) {
        randomWords(windWords);  
      }

      // add photo and position to weatherImageArray
      weatherImageArray.push ({ name: dollyWordsObject.image, position: dollyWordsObject.position });

      return dollyWords;
    }




    // get latitude and longitude from browser
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(getWeatherPosition); //takes showPosition as callback function and returns position
      } else {
        document.getElementById("location").innerHTML = "Geolocation is not supported by this browser.";
      }
    }



    
    // look up weather zone and grid position within the zone. also gets city and state.
    function getWeatherPosition(position) {
      let xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          positionResult = JSON.parse(this.responseText);
          
          document.getElementById("location").innerHTML = 
            "<p>Location: <b>" + positionResult.properties.relativeLocation.properties.city + ", " + 
            positionResult.properties.relativeLocation.properties.state +
            "</b> (Latitude: " + position.coords.latitude + ", Longitude: " + position.coords.longitude +
            ")</p>"           
          ;
          
          loadWeather(positionResult.properties.gridId, positionResult.properties.gridX, positionResult.properties.gridY);
          getWeatherHourly(positionResult.properties.gridId, positionResult.properties.gridX, positionResult.properties.gridY);
          getWeatherAlert(position.coords.latitude, position.coords.longitude);
        }
      };
      xhttp.open("GET", "https://api.weather.gov/points/" + position.coords.latitude + "," + position.coords.longitude, true);
      xhttp.send();
    }




    // get and display daily weather report
    // it fetches data (positions 0-13) from weather service API
    // it then adds them to two arrays. one for expanded forecasts. one for abbreviated forecasts
    function loadWeather(office, x, y) {
      let xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          weatherResult = JSON.parse(this.responseText);         
          console.log(weatherResult);

          // store today's forecast into the array
          // if already passed noon, need to make first day just tonight (half day)
          let dayStart = 0; // 1 if positions start with a half-day forecast. Otherwise 0.
          let hourlyDayCount = 0; // used to build links to hourly forecasts
          
          // if starting with a half day
          if (weatherResult.properties.periods[0].name == "Tonight" || weatherResult.properties.periods[0].name == "Overnight") {
            
            weatherResultArray.push (`
              <div id="full0" class="today col-xl-3 col-md-5">
                <h2> ${weatherResult.properties.periods[0].name}</h2> 
                <p><b>Forecast:</b> ${weatherResult.properties.periods[0].shortForecast}, 
                <b>Temperature:</b> ${weatherResult.properties.periods[0].temperature}, 
                <b>Wind:</b> ${weatherResult.properties.periods[0].windSpeed} ${weatherResult.properties.periods[0].windDirection}
                <br> ${weatherResult.properties.periods[0].detailedForecast}</p>

                <div class="dollysays">
                  <h2>Dolly says</h2> 
                  <p>${dollySays(0, 0, 1)}</p>
                </div>

                <p><a href="#hourly${hourlyDayCount}">Hour-by-hour walk forecast</a></p>
              </div>
            `);
            
            weatherAbbreviationArray.push (`
                <div id="abbreviated0" class='col-md daily' onclick="changeForecast(0, this);">
                  <div class="circle">
                    Now
                  </div> 
                  <p><b> ${weatherResult.properties.periods[0].name}</b> 
                  <br>${weatherResult.properties.periods[0].shortForecast}
                  <br>${weatherResult.properties.periods[0].temperature}F</p> 
                </div>
            `);
            weatherAbbreviationArray[weatherAbbreviationArray.length-1] = weatherAbbreviationArray[weatherAbbreviationArray.length-1].replace("Thunderstorm", "Storm");
            
            dayStart = 1;
            if (weatherResult.properties.periods[0].name !== "Overnight") {
              hourlyDayCount = 1;
            }
          }

          let currentDayAbbreviation;
          let currentDayArray; // used to split holiday names so we can get the first letters for an abbreviation. example Memorial Day abbreviation is MD
          
          //add rest of the full days into the array
          for (i=dayStart; i < weatherResult.properties.periods.length; i=i+2) {          
            
            
            // create abbreviation of the day of the week
            currentDayAbbreviation = "";
            if (weatherResult.properties.periods[i].name == "Today" || weatherResult.properties.periods[i].name == "This Afternoon") {
              currentDayAbbreviation ="Now";
            }
            //if current day has a space (is a special holiday), get first letter then each letter after the space
            else if (weatherResult.properties.periods[i].name.includes(" ")){
              currentDayArray = weatherResult.properties.periods[i].name.split(" ");
              function getFirstLetters(item) {
                currentDayAbbreviation = currentDayAbbreviation + item.slice(0, 1);
              }
              currentDayArray.forEach(getFirstLetters);
            }
            // else just use the first two letters of the day of the week
            else{
              currentDayAbbreviation = weatherResult.properties.periods[i].name.slice(0, 2);
            }
            
                        
            // if full day (has a morning and evening)
            if (i+1 < weatherResult.properties.periods.length) {

              // add full day to weather results array
              weatherResultArray.push (`
                <div id="full${weatherResultArray.length}" class="today col-xl-3 col-md-5">
                  <h2> ${weatherResult.properties.periods[i].name}</h2> 
                  <p><b>Forecast:</b> ${weatherResult.properties.periods[i].shortForecast}, 
                  <b>Temperature:</b> ${weatherResult.properties.periods[i].temperature}, 
                  <b>Wind:</b> ${weatherResult.properties.periods[i].windSpeed} ${weatherResult.properties.periods[i].windDirection}
                  <br> ${weatherResult.properties.periods[i].detailedForecast}</p>

                  <h2> ${weatherResult.properties.periods[i+1].name}</h2> 
                  <p><b>Forecast:</b> ${weatherResult.properties.periods[i+1].shortForecast}, 
                  <b>Temperature:</b> ${weatherResult.properties.periods[i+1].temperature}, 
                  <b>Wind:</b> ${weatherResult.properties.periods[i+1].windSpeed} ${weatherResult.properties.periods[i+1].windDirection}
                  <br> ${weatherResult.properties.periods[i+1].detailedForecast}</p>

                  <div class="dollysays">
                    <h2>Dolly says</h2> 
                    <p>${dollySays(hourlyDayCount, i, 2)}</p>
                  </div>

                  <p><a href="#hourly${hourlyDayCount}">Hour-by-hour walk forecast</a></p>

                </div>
              `);
              
              // add full day to weather abbreviations array
              weatherAbbreviationArray.push (`
                <div id="abbreviated${weatherAbbreviationArray.length}" class='col-md daily' onclick="changeForecast(${weatherResultArray.length-1}, this);">
                  <div class="circle">
                    ${currentDayAbbreviation}
                  </div> 
                  <p><b>${weatherResult.properties.periods[i].name}</b> 
                  <br>${weatherResult.properties.periods[i].shortForecast}
                  <br>${weatherResult.properties.periods[i].temperature}F, 
                  ${weatherResult.properties.periods[i+1].temperature}F</p> 
                </div>
              `);
              weatherAbbreviationArray[weatherAbbreviationArray.length-1] = weatherAbbreviationArray[weatherAbbreviationArray.length-1].replace("Thunderstorm", "Storm");
            

            // else add half day to weather results array
            } else {
              weatherResultArray.push (`
                <div id="full${weatherResultArray.length}" class="today col-xl-3 col-md-5">
                  <h2> ${weatherResult.properties.periods[i].name}</h2> 
                  <p><b>Forecast:</b> ${weatherResult.properties.periods[i].shortForecast}, 
                  <b>Temperature:</b> ${weatherResult.properties.periods[i].temperature}, 
                  <b>Wind:</b> ${weatherResult.properties.periods[i].windSpeed} ${weatherResult.properties.periods[i].windDirection}
                  <br> ${weatherResult.properties.periods[i].detailedForecast}</p>

                  <div class="dollysays">
                    <h2>Dolly says</h2> 
                    <p>${dollySays(hourlyDayCount, i, 1)}</p>
                  </div>

                  <p><a href="#hourly${hourlyDayCount}">Hour-by-hour walk forecast</a></p>

                </div>
              `);

              weatherAbbreviationArray.push (`
                <div id="abbreviated${weatherAbbreviationArray.length}" class='col-md daily' onclick="changeForecast(${weatherResultArray.length-1}, this);">
                  <div class="circle">
                    ${currentDayAbbreviation}
                  </div> 
                  <p><b>${weatherResult.properties.periods[i].name}</b> 
                  <br>${weatherResult.properties.periods[i].shortForecast}
                  <br>${weatherResult.properties.periods[i].temperature}F</p> 
                </div>
              `);
              weatherAbbreviationArray[weatherAbbreviationArray.length-1] = weatherAbbreviationArray[weatherAbbreviationArray.length-1].replace("Thunderstorm", "Storm");
            
            }
            hourlyDayCount++;
          }
      
          // print today's expanded forecast into the div with the today id
          let dailyForecastText = document.getElementById("dailyforecast");
          dailyForecastText.insertAdjacentHTML("beforeend", weatherResultArray[0]);           

          // print the rest of the abbreviated daily forecasts into the div with the dailyforecast id
          for (i=1; i < weatherResultArray.length; i++) {          
              dailyForecastText.insertAdjacentHTML("beforeend", weatherAbbreviationArray[i]);           
          }
        }
      
      };
      xhttp.open("GET", "https://api.weather.gov/gridpoints/" + office +"/" + x + "," + y + "/forecast", true);
      xhttp.send();
    }




    // swap expanded and abbreviated forecasts. used to pop out forecast with onclick event
    function changeForecast(dayNumber, thisElement) {
      // convert expanded day to abbreviated day
      let temp = document.createElement("div");
      let todayNumber = document.getElementsByClassName("today")[0].id.charAt(4); //gets number from id full0 ... full8
      temp.innerHTML = weatherAbbreviationArray[todayNumber];
      temp = temp.firstElementChild;
      document.getElementsByClassName("today")[0].replaceWith(temp);
      
      // convert abbreviated day to expanded day
      let temp2 = document.createElement("div");
      temp2.innerHTML = weatherResultArray[dayNumber];
      temp2 = temp2.firstElementChild;
      thisElement.replaceWith(temp2);

      // scroll to 
      if (window.innerWidth < 768){
        document.getElementById("full"+dayNumber).scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"});
      }

      // change picture
      changeImage(dayNumber);
    }




    // change background image based on day's weather
    // it uses image names and positions stored in weatherImageArray[]
    function changeImage(dayNumber) {
      console.log("changing " + dayNumber + " image to " + weatherImageArray[dayNumber].name + " " +  weatherImageArray[dayNumber].position);
      let backdropImage = document.getElementById("backdropimage");
      backdropImage.style.backgroundImage = `url('images/${weatherImageArray[dayNumber].name}')`;
      backdropImage.style.backgroundPosition = weatherImageArray[dayNumber].position;
      
    }






    // get and display hourly weather report
    function getWeatherHourly(office, x, y) {
      let xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          weatherResultHourly = JSON.parse(this.responseText);
          console.log(weatherResultHourly);

          // print the hourly forecast into the div with the hourlyforecast id
          let hourlyForecastText = document.getElementById("hourlyforecast");
          hourlyForecastText.innerHTML = "<h2>Hour-by-hour walk forecast</h2><p>(<b>Ideal walking weather:</b> 6 a.m. to 8 p.m. 40 to 89 degrees and no precipitation.)</p>";
          
          // used to format date. used to convert number into string
          const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
          const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

          let dayCount = 0; // keeps track of the number of days printed

          for (i=0; i <weatherResultHourly.properties.periods.length; i++) {
            
            // convert string from json into a proper date
            let startTime = new Date(weatherResultHourly.properties.periods[i].startTime);
            
            // if first loop, create initial div and header
            if (i==0) {
              hourlyForecastText.insertAdjacentHTML("beforeend", `
              <a id="hourly${dayCount}"></a>
              <div class='hourly'>  
                <h3>${days[startTime.getDay()]}, ${months[startTime.getMonth()]} ${startTime.getDate()}, ${startTime.getFullYear()}</h3>
              </div>
              `);
            }

            // create new div and header if the start of a new day
            if (startTime.getHours()==0 && i!==0) {
              dayCount++;
              hourlyForecastText.insertAdjacentHTML("beforeend", `
              <a id="hourly${dayCount}"></a>
              <div class='hourly'>  
                  <h3>${days[startTime.getDay()]}, ${months[startTime.getMonth()]} ${startTime.getDate()}, ${startTime.getFullYear()}</h3>
                </div>
              `);
            }

            // insert text into most recent date's div
            // print formatted time
            if (startTime.getHours()==0) {
              hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
                <b>Midnight, </b>
              `);
            } else if (startTime.getHours() < 12)  {
              hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
                <b>${startTime.getHours()} a.m., </b> 
              `);
            } else if (startTime.getHours() == 12) {
              hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
                <b>Noon, </b>
              `);
            } else {
              hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
                <b>${startTime.getHours()-12} p.m., </b>
              `);
            }

            // print forecast, temperature and wind
            hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
              ${weatherResultHourly.properties.periods[i].shortForecast}, 
              ${weatherResultHourly.properties.periods[i].temperature}F, 
              wind ${weatherResultHourly.properties.periods[i].windSpeed} ${weatherResultHourly.properties.periods[i].windDirection} 
            `);

            // is good for walk?
            if (weatherResultHourly.properties.periods[i].temperature >= 40 && weatherResultHourly.properties.periods[i].temperature < 90 &&
                startTime.getHours() >= 6 && startTime.getHours() <= 20 && 
                (weatherResultHourly.properties.periods[i].shortForecast == "Sunny" || 
                weatherResultHourly.properties.periods[i].shortForecast == "Mostly Sunny" ||
                weatherResultHourly.properties.periods[i].shortForecast == "Partly Sunny" ||
                weatherResultHourly.properties.periods[i].shortForecast == "Partly Cloudy" ||
                weatherResultHourly.properties.periods[i].shortForecast == "Mostly Cloudy" ||
                weatherResultHourly.properties.periods[i].shortForecast == "Cloudy" || 
                weatherResultHourly.properties.periods[i].shortForecast == "Clear" || 
                weatherResultHourly.properties.periods[i].shortForecast == "Mostly Clear" || 
                weatherResultHourly.properties.periods[i].shortForecast == "Partly Clear")) {
              hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
              <b><span style="color:red">(WALK)</span></b> 
            `);
            }

            hourlyForecastText.lastElementChild.insertAdjacentHTML("beforeend", `
              <br>
            `);

          }
          changeImage(0);
        }
      };
      xhttp.open("GET", "https://api.weather.gov/gridpoints/" + office +"/" + x + "," + y + "/forecast/hourly", true);
      xhttp.send();
    }





    // get and display weather alerts
    // example api call: https://api.weather.gov/alerts/active?point=37.52985065563401,-77.41054289211888
    function getWeatherAlert(latitude, longitude) {
      let xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          
          weatherAlert = JSON.parse(this.responseText);
          console.log(weatherAlert);

          // print the hourly forecast into the div with the hourlyforecast id
          let alertText = document.getElementById("weatheralertbody");

          // checks to see if alerts exist
          if (weatherAlert.features.length==0){
            alertText.innerHTML = `
              <p>There are no active weather alerts for your location. </p>
            `;
          
          // loop through alerts and display if they exist
          } else {

            document.getElementById("weatheralertouter").style.display = "block";

            alertText.innerHTML = "";
            for (i=0; i<weatherAlert.features.length; i++) {
              alertText.insertAdjacentHTML("beforeend", `
                  <h3>${weatherAlert.features[i].properties.event}</h3> 
                  <p><b>${weatherAlert.features[i].properties.headline}</b> 
                  ${weatherAlert.features[i].properties.description}</p>
              `);
              if (weatherAlert.features[i].properties.instruction !== null) {
              alertText.insertAdjacentHTML("beforeend", `
                  <p>${weatherAlert.features[i].properties.instruction}</p>
              `);}
            }

          }
        }
      };
      xhttp.open("GET", `https://api.weather.gov/alerts/active?point=${latitude},${longitude}`, true);
      xhttp.send();
    }


    // toggles the display of weatheralertsbody when used with onclick event
    function toggleWeatherAlert() {
      let alertBody = document.getElementById("weatheralertbody");
      
      if (alertBody.style.display === "block") {
        alertBody.style.display = "none";
      } else {
        alertBody.style.display = "block";
      }
    }


    
    // hide header when page is scrolled down
    function hideHeader() {
      if ((window.innerWidth >= 768 && window.pageYOffset >= 400) ||(window.innerWidth < 768 && window.pageYOffset >= 100) ) {
        document.getElementById("header").style.top = "-600px";
      } else {
        document.getElementById("header").style.top = "0px";
      }
    }

    
  </script>

</html>